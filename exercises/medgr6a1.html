<!DOCTYPE html>
<html data-require="math math-format graphie time interactive angles">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>繪製圓形圖-2</title>
    <script src="../khan-exercise.js"></script>
	<style type="text/css">
        #answer_area .sol input[type=text] {
            width: 35px;
        }
		#answer_area .entry input[type=text] {
            width: 35px;
        }
		table.nLimit{margin:5px ;border:1px }
		table.nLimit td { text-align:center;min-width:60px;max-width:100px;border: 1px solid #AAA; padding: 5px;}
        </style>
		<script type="text/javascript">
		function bubbleSort(array) {
			var i = 0,
			len = array.length,
			j, d;
			for (; i < len; i++) {
				for (j = 0; j < len; j++) {
					if (array[i][1] < array[j][1]) {
						d = array[j];
						array[j] = array[i];
						array[i] = d;
					}
				}
			}
			return array;
		}
	</script>
</head>
<body>
	<div class="exercise">
    <div class="vars">
        <var id="names">randFromArray(["小玉","珍珍","小紅","娟娟","冠宏","小惠","阿光","宜生"])</var>
        <var id="table_name,item_name,item_1,item_2,item_3,item_4,item_5,item_unit,unit">
            randFromArray([[names+"家今年一月份的支出","支出項目","房租","伙食","交通","雜支","休閒","支出","元"],
                           ["超市去年營業額","項目","家電","蔬果","食品","生活用品","飲料","營業額","千元"],
                           ["健康國小六年級學生喜好休閒活動","休閒活動","打籃球","打棒球","閱讀","畫畫","聽音樂","人數","人"],
                           ["調查學生心中首選寵物","寵物","狗","貓","兔子","天竺鼠","鳥","人數","人"],
                           ["民眾如何安排假期活動","假期活動","拜訪親友","待在家裡","觀光旅遊","沒有休假","運動休閒","人數","人"],
                           ["湖中國小六年級學生最喜歡的球類運動","球類運動","足球","躲避球","籃球","排球","羽球","人數","人"],
                           ["樂樂國小合作社不同品牌飲料賣出的數量","飲料種類","果汁","茶","運動飲料","水","可可","數量","瓶"],
                           ["流星國小最喜歡的亞洲國家","國家名稱","日本","韓國","新加坡","香港","澳門","人數","人"],
                           ["花兒國小六年級購買零食考慮因素","考慮因素","熱量","味道","價格","份量","品牌","得票數","票"],
                           ["均一餐廳午餐銷售情形","種類","水餃","麵類","飯類","飲料","甜點","數量","份"],
                           [names+"一家人到宜蘭自助旅行的花費","項目","餐飲","住宿","門票","交通","雜支","花費","千元"],
                           ["太陽國小六年級票選運動會代表吉祥物的得票數","吉祥物","浣熊","熊貓","綿羊","大象","貓頭鷹","得票數","票"],
                           [names+"到水上樂園遊玩一日花費","項目","午餐","飲料","車資","門票","零食","花費","元"]])
<!--                           ["宜生國小六年級學生血型統計表","血型","A型","B型","AB型","O型","人數","人"],-->
        </var>
    </div>
    <div class="problems">
	    <div id="case1-classify-two-chart"  data-weight=1>
            <div class="vars" data-ensure="abs(J-K)&gt;10 && abs(K-L)&gt;10 && abs(L-M)&gt;10 && abs(M-J)&gt;10">
                <var id="test">(function(){Khan.scratchpad.disable();})()</var>
                <var id="GCD">randRange(2,7)</var>
                <var id="total">randFromArray([20,25,50])*GCD</var>
                <var id="num_item">randRange(4,5)</var>
                <var id="numsArray">
                (function(){
                    var arr = sortNumbers(randRangeUnique(1,total/GCD,num_item-1));
                    if(num_item == 5) {
                        var retArr = [arr[0],arr[1]-arr[0],arr[2]-arr[1],arr[3]-arr[2],total/GCD-arr[3]];
                    }  
                    else {
                        var retArr = [arr[0],arr[1]-arr[0],arr[2]-arr[1],total/GCD-arr[2]];
                    }
                    return retArr;
                })()</var>
                <var id="J_data">numsArray[0]*GCD</var>
                <var id="K_data">numsArray[1]*GCD</var>
                <var id="L_data">numsArray[2]*GCD</var>
                <var id="M_data">numsArray[3]*GCD</var>
                <var id="J">J_data*100/total</var>
                <var id="K">K_data*100/total</var>
                <var id="L">L_data*100/total</var>
                <var id="M">M_data*100/total</var>
                <var data-if="num_item==5" id="N_data">numsArray[4]*GCD</var>
                <var data-if="num_item==5" id="N">N_data*100/total</var>
                <var id="question-type">randRange(0,2)</var>
            </div>
			
			<div class="question">
                <p>下圖是<var>table_name</var>的圓形圖。</p>
                <div class="graphie" id="circle" style="float:left">
                    init({ range: [[-4, 6.5], [-3, 3]], scale: 45 });
                    leftCenter = [-2,0];
                    rightCenter = [2,0];
                    radius = 1.8;

                    color_list = ["#9FE0F6","#FFA500","#EEFFA5","#DE9DD6","#97EC71"];

                    cart_item1 = [radius,0];
                    cart_item2 = polar(radius,J*3.6);
                    cart_item3 = polar(radius,J*3.6+K*3.6);
                    cart_item4 = polar(radius,J*3.6+K*3.6+L*3.6);
                    left_item1 = [cart_item1[0]+leftCenter[0],cart_item1[1]];
                    left_item2 = [cart_item2[0]+leftCenter[0],cart_item2[1]];
                    left_item3 = [cart_item3[0]+leftCenter[0],cart_item3[1]];
                    left_item4 = [cart_item4[0]+leftCenter[0],cart_item4[1]];
                    right_item1 = [cart_item1[0]+rightCenter[0],cart_item1[1]];
                    right_item2 = [cart_item2[0]+rightCenter[0],cart_item2[1]];
                    right_item3 = [cart_item3[0]+rightCenter[0],cart_item3[1]];
                    right_item4 = [cart_item4[0]+rightCenter[0],cart_item4[1]];
                    if(num_item == 5){
                        cart_item5 = polar(radius,J*3.6+K*3.6+L*3.6+M*3.6);
                        left_item5 = [cart_item5[0]+leftCenter[0],cart_item5[1]];
                        right_item5 = [cart_item5[0]+rightCenter[0],cart_item5[1]];
                    }

                    //Circle 1

                    arc(leftCenter,radius,0,J*3.6,{fill:color_list[0]});
                    path([leftCenter,[cart_item1[0]+leftCenter[0],cart_item1[1]],[cart_item2[0]+leftCenter[0],cart_item2[1]],leftCenter], {stroke: color_list[0] , fill: color_list[0] });
                    arc(leftCenter,radius,J*3.6,J*3.6+K*3.6,{fill:color_list[1]});
                    path([leftCenter,[cart_item2[0]+leftCenter[0],cart_item2[1]],[cart_item3[0]+leftCenter[0],cart_item3[1]],leftCenter], {stroke: color_list[1],fill: color_list[1]});
                    arc(leftCenter,radius,J*3.6+K*3.6,J*3.6+K*3.6+L*3.6,{fill:color_list[2]});
                    path([leftCenter,[cart_item3[0]+leftCenter[0],cart_item3[1]],[cart_item4[0]+leftCenter[0],cart_item4[1]],leftCenter], {stroke: color_list[2],fill: color_list[2]});
                    
                    if(num_item == 4){
                        arc(leftCenter,radius,J*3.6+K*3.6+L*3.6,360,{fill:color_list[3]});
                        path([leftCenter,[cart_item4[0]+leftCenter[0],cart_item4[1]],[cart_item1[0]+leftCenter[0],cart_item1[1]],leftCenter], {stroke: color_list[3],fill: color_list[3]});
                    }
                    else{
                        arc(leftCenter,radius,J*3.6+K*3.6+L*3.6,J*3.6+K*3.6+L*3.6+M*3.6,{fill:color_list[3]});
                        path([leftCenter,[cart_item4[0]+leftCenter[0],cart_item4[1]],[cart_item5[0]+leftCenter[0],cart_item5[1]],leftCenter], {stroke: color_list[3],fill: color_list[3]});
                    }

                    circle(leftCenter,radius);
                    line(leftCenter,left_item1);
                    line(leftCenter,left_item2);
                    line(leftCenter,left_item3);
                    line(leftCenter,left_item4);

                    //Circle 2
                    circle(rightCenter,radius);
                    line(rightCenter,right_item1);
                    line(rightCenter,right_item2);
                    line(rightCenter,right_item3);
                    line(rightCenter,right_item4);                    

                    if(num_item==5){
                        line(leftCenter,left_item5);
                        line(rightCenter,right_item5);
                    }
                    label_ratio = 2;

                    cart_label1 = polar(radius/2,J*1.8);
                    cart_label2 = polar(radius/2,J*3.6+K*1.8);
                    cart_label3 = polar(radius/2,J*3.6+K*3.6+L*1.8);
                    cart_label4 = polar(radius/2,J*3.6+K*3.6+L*3.6+M*1.8);
                    if(num_item==5){
                        cart_label5 = polar(radius/2,J*1.8+K*1.8+L*1.8+M*1.8+180);
                    }
                    
                    // item percent
                    label( [cart_label1[0]+rightCenter[0],cart_label1[1]],  "\\small{"+J+"\\%}", "center", { color: "#000000" });
                    label( [cart_label2[0]+rightCenter[0],cart_label2[1]],  "\\small{"+K+"\\%}", "center", { color: "#000000" });
                    label( [cart_label3[0]+rightCenter[0],cart_label3[1]],  "\\small{"+L+"\\%}", "center", { color: "#000000" });
                    label( [cart_label4[0]+rightCenter[0],cart_label4[1]],  "\\small{"+M+"\\%}", "center", { color: "#000000" });
                    if(num_item==5){
                        label( [cart_label5[0]+rightCenter[0],cart_label5[1]],  "\\small{"+N+"\\%}", "center", { color: "#000000" });
                    }
                    
                    // amount
                    label( [cart_label1[0]+leftCenter[0],cart_label1[1]],  "\\small{"+J_data+unit+"}", "center", { color: "#000000" });
                    label( [cart_label2[0]+leftCenter[0],cart_label2[1]],  "\\small{"+K_data+unit+"}", "center", { color: "#000000" });
                    label( [cart_label3[0]+leftCenter[0],cart_label3[1]],  "\\small{"+L_data+unit+"}", "center", { color: "#000000" });
                    label( [cart_label4[0]+leftCenter[0],cart_label4[1]],  "\\small{"+M_data+unit+"}", "center", { color: "#000000" });
                    if(num_item==5){
                        label( [cart_label5[0]+leftCenter[0],cart_label5[1]],  "\\small{"+N_data+unit+"}", "center", { color: "#000000" });
                    }
                    
                    // item square
                    
                    square_size = 0.5;
                    for( var i=0 ; i &lt; num_item ; i++){
                        path([[4.3,num_item-i-2.5+square_size/2],[4.3,num_item-i-2.5-square_size/2],[4.3+square_size,num_item-i-2.5-square_size/2],[4.3+square_size,num_item-i-2.5+square_size/2],[4.3,num_item-i-2.5+square_size/2]], {stroke: "#000000",fill: color_list[i]});
                    }

                    // item name
                    label( [5,num_item-2.5],  "\\large{"+item_1+"}", "right", { color: "#000000" });
                    label( [5,num_item-3.5],  "\\large{"+item_2+"}", "right", { color: "#000000" });
                    label( [5,num_item-4.5],  "\\large{"+item_3+"}", "right", { color: "#000000" });
                    label( [5,num_item-5.5],  "\\large{"+item_4+"}", "right", { color: "#000000" });
                    if(num_item==5){
                        label( [5,num_item-6.5],  "\\large{"+item_5+"}", "right", { color: "#000000" });
                    }
                                                            
                </div>
 
                
                <table class="nLimit" style="background-color:#F8F8F8">
                    <tr><td><var>item_name</var></td><td><var>item_1</var></td><td><var>item_2</var></td><td><var>item_3</var></td><td><var>item_4</var></td></tr>
                    <tr><td> 圓心角(度) </td><td><code><var>J</var>^\circ</code></td><td><code><var>K</var>^\circ</code></td><td><code><var>L</var>^\circ</code></td><td><code><var>M</var>^\circ</code></td></tr>
                </table>
 
				<p style="font-weight: bold">我們將圓周分為 <code>360</code> 小格，每一小格是 <code>1</code> 度，每一大格是 <code>5</code> 度，請根據上表的圓心角，畫出圓形圖。</p>
				<!--
                <p style="font-weight: bold"><code><var>J</var>\%</code>、<code><var>K</var>\%</code>、<code><var>L</var>\%</code>、<code><var>M</var>\%</code> 。</p>
                -->
                <p style="font-weight: bold">下圖單位：度</p>
			</div>
			<div class="problem">
				<div class="graphie" id="clock">
                        
                </div>
			</div>
            <div class="solution" data-type="multiple">
				<div class="sol" data-type="custom">
				    <div class="guess"></div>
				    <div class="validator-function">
                    </div>
				</div>
				<p class="example">移動圓內直線，使其滿足題目中給出的條件</p>
            </div>
			
			<div class="hints">
				<div>

				</div>
            </div>
		</div>
        <div id="case2-classify-the-items-from-chart">
        <div class="vars" data-ensure="abs(a5-a1)&gt;5 && abs(a5-a2)&gt;5 && abs(a5-a3)&gt;5 && abs(a5-a4)&gt;5">
                <var id="test">(function(){Khan.scratchpad.disable();})()</var>
                <var id="a1">randRange(5,8)</var>
                <var id="a2">randRange(12,18)</var>
                <var id="a3">randRange(22,28)</var>
                <var id="a4">randRange(32,38)</var>
                <var id="a5">100-a1-a2-a3-a4</var>
                <var id="numsArray">
                (function(){
                    var retArr = [a1,a2,a3,a4,100-a1-a2-a3-a4].sort(function(){ return 0.5 - Math.random() });
                    return retArr;
                })()</var>
                <var id="J">numsArray[0]</var>
                <var id="K">numsArray[1]</var>
                <var id="L">numsArray[2]</var>
                <var id="M">numsArray[3]</var>
                <var id="N">numsArray[4]</var>
                <var id="sortArray">sortNumbers(numsArray)</var>
                <var id="SORT_ALL">(function(){
                    var all = [[item_1,K],[item_2,L],[item_3,M],[item_4,N],[item_5,J]];
                    return bubbleSort(all);
                })()</var>
                
        </div>
        <div class="question">
            <p>下面是<var>table_name</var>的圓形圖。如果圖中五項花費所占的百分率分別為 <code><var>J</var>\%</code> 、<code><var>K</var>\%</code> 、<code><var>L</var>\%</code> 、<code><var>M</var>\%</code> 、<code><var>N</var>\%</code> ，請將百分率填入下面的括號中。</p>
        </div>
        <div class="problem">
            <div class="graphie" id="circle" style="float:left">
                init({ range: [[-4, 4], [-4, 4]], scale: 45 });
                circle([0,0],4);
                line([0,0],[4,0]);
                line([0,0],polar(4,J*3.6));
                line([0,0],polar(4,J*3.6+K*3.6));
                line([0,0],polar(4,J*3.6+K*3.6+L*3.6));
                line([0,0],polar(4,J*3.6+K*3.6+L*3.6+M*3.6));
                
                label( polar(2,J*1.8),  "\\large{"+item_5+"}", "center", { color: "#6495ED" });
                label( polar(2,J*3.6+K*1.8),  "\\large{"+item_1+"}", "center", { color: "#FFA500" });
                label( polar(2,J*3.6+K*3.6+L*1.8),  "\\large{"+item_2+"}", "center", { color: "red" });
                label( polar(2,J*3.6+K*3.6+L*3.6+M*1.8),  "\\large{"+item_3+"}", "center", { color: "#28AE7B" });
                label( polar(2,J*1.8+K*1.8+L*1.8+M*1.8+180),  "\\large{"+item_4+"}", "center", { color: "purple" });
            </div>
            <div style="float:right">
                <table>
                    <tr><td><var>item_1</var>：<input type="text" style="width:40px" id="a_1"><code>\%</code></td></tr>
                    <tr><td><var>item_2</var>：<input type="text" style="width:40px" id="a_2"><code>\%</code></td></tr>
                    <tr><td><var>item_4</var>：<input type="text" style="width:40px" id="a_3"><code>\%</code></td></tr>
                    <tr><td><var>item_3</var>：<input type="text" style="width:40px" id="a_4"><code>\%</code></td></tr>
                    <tr><td><var>item_5</var>：<input type="text" style="width:40px" id="a_5"><code>\%</code></td></tr>
                </table>
            </div>
        </div>
        <div class="solution" data-type="multiple">
                <div class="sol" data-type="custom">
                    <div class="guess">[$("#a_1").val().replace(/[ ]/g,""),$("#a_2").val().replace(/[ ]/g,""),$("#a_3").val().replace(/[ ]/g,""),$("#a_4").val().replace(/[ ]/g,""),$("#a_5").val().replace(/[ ]/g,"")]</div>
                    <div class="validator-function">
                        if(guess[0]=='' || guess[1]=='' || guess[2]=='' || guess[3]=='' || guess[4]==''){
                            return "";
                        }
                        if(guess[0]==K && guess[1]==L && guess[2]==N && guess[3]==M && guess[4]==J){
                            return true;
                        }
                        return false;
                    </div>
                </div>
                <p class="example">在圖中填空處填入整數，<br/>例如 <code>6</code></p>
        </div>
        <div class="hints">
            <div style="clear:both">
                <p><br/>我們先依這五項花費的大小順序排列 <code>:</code><br /><code><var>sortArray[4]</var>\%><var>sortArray[3]</var>\%><var>sortArray[2]</var>\%><var>sortArray[1]</var>\%><var>sortArray[0]</var>\%</code></p>
            </div>
            <div>
                <p>
                    從圓形圖中，我們可以將<var>item_name</var>從大到小排列：<br />
                    <var>SORT_ALL[4][0]</var>、<var>SORT_ALL[3][0]</var>、<var>SORT_ALL[2][0]</var>、<var>SORT_ALL[1][0]</var>、<var>SORT_ALL[0][0]</var>。
                </p>
            </div>
            <div>
                <p>所以，我們可以知道 <code>:</code></p>
                <p style="font-weight : bold"><var>SORT_ALL[4][0]</var>是 <code class="hint_pink"><var>SORT_ALL[4][1]</var>\%</code></p>
            </div>
            <p style="font-weight : bold"><var>SORT_ALL[3][0]</var>是 <code class="hint_pink"><var>SORT_ALL[3][1]</var>\%</code></p>
            <p style="font-weight : bold"><var>SORT_ALL[2][0]</var>是 <code class="hint_pink"><var>SORT_ALL[2][1]</var>\%</code></p>
            <p style="font-weight : bold"><var>SORT_ALL[1][0]</var>是 <code class="hint_pink"><var>SORT_ALL[1][1]</var>\%</code></p>
            <p style="font-weight : bold"><var>SORT_ALL[0][0]</var>是 <code class="hint_pink"><var>SORT_ALL[0][1]</var>\%</code></p>
        </div>                                                 
            
        </div>
        <!-- need to figure out how to validate the fraction input -->
        <div id="case3-data-to-ratio" data-weight=1>
            <div class="vars">
                <var id="test">(function(){Khan.scratchpad.disable();})()</var>
                <var id="GCD">randRange(2,7)</var>
                <var id="ratio">randFromArray([3,5,6,10,12,15,18,20])</var>
                <var id="total">360/ratio</var> <!--ratio*GCD-->
                <var id="numsArray">
                (function(){
                    var arr = sortNumbers(randRangeUnique(1,360/ratio,3));
                    var retArr = [arr[0],arr[1]-arr[0],arr[2]-arr[1],(360/ratio)-arr[2]];
                    return retArr;
                })()</var>
                <var id="J">numsArray[0]</var>
                <var id="K">numsArray[1]</var>
                <var id="L">numsArray[2]</var>
                <var id="M">numsArray[3]</var>
                <var id="J_percent">roundTo(2,J/total)</var>
                <var id="K_percent">roundTo(2,K/total)</var>
                <var id="L_percent">roundTo(2,L/total)</var>
                <var id="M_percent">roundTo(2,M/total)</var>

            </div>
        <div class="question">
            <p style="font-weight:bold">下表是<var>table_name</var>，表中的數字表示每一種<var>item_name</var>的<var>item_unit</var>。</p>
            <table class="nLimit"  style="background-color:#F8F8F8">
                <tr><td><var>item_name</var></td><td><var>item_1</var></td><td><var>item_2</var></td><td><var>item_3</var></td><td><var>item_4</var></td></tr>
                <tr><td><var>item_unit</var>(<var>unit</var>)</td><td><code><var>J</var></code></td><td><code><var>K</var></code></td><td><code><var>L</var></code></td><td><code><var>M</var></code></td></tr>
            </table>
        </div>
        <div class="problem">
            <p>請算出每種<var>item_name</var>的<var>item_unit</var>所占的比率，並將比率用小數表示，填入下表。
        </p></div>
        <table class="nLimit"  style="background-color:#F8F8F8">
                <tr><td><var>item_name</var></td><td><var>item_1</var></td><td><var>item_2</var></td><td><var>item_3</var></td><td><var>item_4</var></td></tr>
                <tr><td>比率</td><td><input type="rational" id="a_1" style="height:60px;width:50px;background:#FFFFFF;border:0px;text-align:center"></td><td><input type="text" id="a_2" style="height:60px;width:50px;background:#FFFFFF;border:0px;text-align:center"></td><td><input type="text" id="a_3" style="height:60px;width:50px;background:#FFFFFF;border:0px;text-align:center"></td><td><input type="text" id="a_4" style="height:60px;width:50px;background:#FFFFFF;border:0px;text-align:center"></td></tr>
        </table>
        <div class="solution" data-type="multiple">
            <div class="sol" data-type="custom">
                    <div class="guess">[$('#a_1').val().replace(/[ ]/g,""),$('#a_2').val().replace(/[ ]/g,""),$('#a_3').val().replace(/[ ]/g,""),$('#a_4').val().replace(/[ ]/g,"")]</div>
                    <div class="validator-function">
                        if(guess[0]=='' || guess[1]=='' || guess[2]=='' || guess[3]==''){
                            return '';
                        }
                        if(roundTo(2,guess[0])==J_percent && roundTo(2,guess[1])==K_percent && roundTo(2,guess[2])==L_percent && roundTo(2,guess[3])==M_percent){
                            return true;
                        }
                        return false;
                    </div>
                </div>
                <p class="example">在表中填入分數，例如 <code>1/6</code></p>
        </div>
        <div class="hints">
            <p>我們要先計算出全部有多少：<code><var>J</var>+<var>K</var>+<var>L</var>+<var>M</var>=<var>total</var></code>。</p>
            <p><var>item_1</var>占全部的比率是：</br>
                <code>\quad<var>J</var>\div <var>total</var>=\dfrac{<var>J</var>}{<var>total</var>}=</code><code class="hint_pink">\color{fuchsia}{<var>fraction(J,total,true,true,false,false)</var>}</code></p>
            <p><var>item_2</var>占全部的比率是：</br>
                <code>\quad<var>K</var>\div <var>total</var>=\dfrac{<var>K</var>}{<var>total</var>}=</code><code class="hint_pink">\color{fuchsia}{<var>fraction(K,total,true,true,false,false)</var>}</code></p>
            <p><var>item_3</var>占全部的比率是：</br>
                <code>\quad<var>L</var>\div <var>total</var>=\dfrac{<var>L</var>}{<var>total</var>}=</code><code class="hint_pink">\color{fuchsia}{<var>fraction(L,total,true,true,false,false)</var>}</code></p>
            <p><var>item_4</var>占全部的比率是：</br>
                <code>\quad<var>M</var>\div <var>total</var>=\dfrac{<var>M</var>}{<var>total</var>}=</code><code class="hint_pink">\color{fuchsia}{<var>fraction(M,total,true,true,false,false)</var>}</code></p>
        </div>
        </div>        
	</div>
	</div>
</body>
</html>