<!DOCTYPE html> <html data-require="math math-format expressions rational-expressions">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>有理式的加減 3</title>
    <script src="../khan-exercise.js"></script>
	<script type="text/javascript">
		function addPlusChar(arr){
			for(var i = 0;i<arr.length;i++){
				if(arr[i].charAt(0)=="+"){
					arr[i]=arr[i].substr(1,arr.length);
				}
			}
			return arr;
		}
		function checkArr(arr1,arr2){
			if(arr1.length!=arr2.length){
				return false;
			}
			for(var i = 0;i<arr1.length;i++){
				if(arr1[i]!=arr2[i]){
					return false;
				}
			}
			return true;
		}
		function reverseStr(str){
			if(str.charAt(0)=='-'){
				return str.substr(1,str.length);
			}else return '-'+str;
		}
		function checkReverse(arr1,arr2){
			if(arr1.length!=arr2.length){
				return false;
			}
			var arrNew = arr2;
			for(var i = 0;i<arr1.length;i++){
				for(var j = 0;j<arrNew.length;j++){
					if(reverseStr(arr1[i])==arrNew[j]){
						arrNew.splice(j,1);
					}
				}
			}
			if(arrNew.length!=0){
				return false;
			}
			return true;
		}
	</script>
</head>
<body>
    <div class="exercise">
        <div class="vars">
            <var id="SIGN">randFromArray(["+", "-"])</var>
            <var id="ORDER">rand(2)</var>
            <var id="X">randVar()</var>
            <var id="Y" data-ensure="X !== Y">randVar()</var>

            <var id="EXPR1">new RationalExpression([[randRangeWeightedExclude(-10, 10, 1, 0.4, [0]),X], randRangeNonZero(-10, 10)])</var>
            <div data-ensure="TERM1.getGCD(TERM2).toString() === '1'">
                <var id="TERM1">new Term(randRangeNonZero(-10, 10))</var>
                <var id="TERM2">new Term(randRange(1, 10))</var>
            </div>
        </div>

        <div class="problems">
            <div id="two-expr">
                <div class="vars">
                    <var id="EXPR2" data-ensure="!EXPR1.divide(EXPR2)">new RationalExpression([[randRangeWeightedExclude(-10, 10, 1, 0.4, [0]),X], randRangeNonZero(-10, 10)])</var>
                    <var id="N1">ORDER ? EXPR1 : TERM1</var>
                    <var id="D1">ORDER ? EXPR2 : TERM2</var>
                    <var id="N2">ORDER ? TERM1 : EXPR1</var>
                    <var id="D2">ORDER ? TERM2 : EXPR2</var>
                    <var id="N_PRODUCT1">N1.multiply(D2)</var>
                    <var id="N_PRODUCT2">N2.multiply(D1)</var>
                    <var id="N_SUM">SIGN === '+' ? N_PRODUCT1.add(N_PRODUCT2) : N_PRODUCT1.add(N_PRODUCT2.multiply(-1))</var>
                    <var id="D_PRODUCT">D2.multiply(D1)</var>
                    <var id="FACTOR">D_PRODUCT.isNegative() ? N_SUM.getGCD(D_PRODUCT).multiply(-1) : N_SUM.getGCD(D_PRODUCT)</var>
                    <var id="NUMERSOL">N_SUM.divide(FACTOR)</var>
                    <var id="DENOMSOL">D_PRODUCT.divide(FACTOR)</var>
                </div>
            </div>

            <div id="expr-top">
                <div class="vars" data-ensure="D1.getGCD(D2).isOne()">
                    <var id="TERM3">rand(2) ? new Term(randRangeExclude(-10, 10, [-1, 0, 1])) : new Term(randRangeExclude(-10, 10, [-1, 0, 1]), X)</var>
                    <var id="N1">ORDER ? EXPR1 : TERM1</var>
                    <var id="D1">ORDER ? TERM3: TERM2</var>
                    <var id="N2">ORDER ? TERM1 : EXPR1</var>
                    <var id="D2">ORDER ? TERM2 : TERM3</var>
                    <var id="N_PRODUCT1">N1.multiply(D2)</var>
                    <var id="N_PRODUCT2">N2.multiply(D1)</var>
                    <var id="N_SUM">SIGN === '+' ? N_PRODUCT1.add(N_PRODUCT2) : N_PRODUCT1.add(N_PRODUCT2.multiply(-1))</var>
                    <var id="D_PRODUCT">D2.multiply(D1)</var>
                    <var id="FACTOR">D_PRODUCT.isNegative() ? N_SUM.getGCD(D_PRODUCT).multiply(-1) : N_SUM.getGCD(D_PRODUCT)</var>
                    <var id="NUMERSOL">N_SUM.divide(FACTOR)</var>
                    <var id="DENOMSOL">D_PRODUCT.divide(FACTOR)</var>
                </div>
            </div>

            <div id="expr-bottom">
                <div class="vars">
                    <var id="TERM3">rand(2) ? new Term(randRangeNonZero(-10, 10)) : new Term(randRangeNonZero(-10, 10), X)</var>
                    <var id="N1">ORDER ? TERM3 : TERM1</var>
                    <var id="D1">ORDER ? EXPR1 : TERM2</var>
                    <var id="N2">ORDER ? TERM1 : TERM3</var>
                    <var id="D2">ORDER ? TERM2 : EXPR1</var>
                    <var id="N_PRODUCT1">N1.multiply(D2)</var>
                    <var id="N_PRODUCT2">N2.multiply(D1)</var>
                    <var id="N_SUM">SIGN === '+' ? N_PRODUCT1.add(N_PRODUCT2) : N_PRODUCT1.add(N_PRODUCT2.multiply(-1))</var>
                    <var id="D_PRODUCT">D2.multiply(D1)</var>
                    <var id="FACTOR">D_PRODUCT.isNegative() ? N_SUM.getGCD(D_PRODUCT).multiply(-1) : N_SUM.getGCD(D_PRODUCT)</var>
                    <var id="NUMERSOL">N_SUM.divide(FACTOR)</var>
                    <var id="DENOMSOL">D_PRODUCT.divide(FACTOR)</var>
                </div>
            </div>
        </div>

        <p class="problem">化簡並展開下式 <code>:</code></p>
        <p class="question"><code>
            <var>Y</var> =
            <span data-if="D1.toString() !== '1'">\dfrac{<var>N1</var>}{<var>D1</var>}</span><span data-else=""><var>N1</var></span>
            <var>SIGN</var>
            <span data-if="D2.toString() !== '1'">\dfrac{<var>N2</var>}{<var>D2</var>}</span><span data-else=""><var>N2</var></span>
        </code></p>

       <div class="solution" data-type="multiple">
			<table>
				<tr><td style="border-bottom:1px solid black"><input type="text" style="width:150px;text-align:center;" id="a1"></td></tr>
				<tr><td style="border-top:1px solid black"><input type="text" style="width:150px;text-align:center" id="a2"></td></tr>
			</table>
			<div class="sol" data-type="custom">
				<div class="guess">[$('#a1').val().toString().replace(/[ ]/g,"").replace(/−/g,'-'),$('#a2').val().toString().replace(/[ ]/g,"").replace(/−/g,'-'),FACTOR.toString() !== '1'?NUMERSOL.toString().replace(/[ ]/g,"").replace(/−/g,'-'):N_SUM.toString().replace(/[ ]/g,"").replace(/−/g,'-'),FACTOR.toString() !== '1'?DENOMSOL.toString().replace(/[ ]/g,"").replace(/−/g,'-'):D_PRODUCT.toString().replace(/[ ]/g,"").replace(/−/g,'-')]</div>
				<div class="validator-function">
					if(guess[0]==""||guess[1]==""){
						return "";
					}
					var ansArr = new Array();
					var ansArrBelow = new Array();
					var ver1 = new Array();
					var ver2 = new Array();
					var ind1 = 0;
					var ind2 = 0;
					var ind3 = 0;
					var ind4 = 0;
					for(var i=1;i&lt;guess[0].length;i++){
						if(guess[0].charAt(i)=="+"||guess[0].charAt(i)=="-"){
							ansArr[ind1] = guess[0].substr(0,i);
							ind1++;
							guess[0] = guess[0].substr(i,guess[0].length);
							i=1;
						}
					}
					for(var i=1;i&lt;guess[1].length;i++){
						if(guess[1].charAt(i)=="+"||guess[1].charAt(i)=="-"){
							ansArrBelow[ind2] = guess[1].substr(0,i);
							ind2++;
							guess[1] = guess[1].substr(i,guess[1].length);
							i=1;
						}
					}
					for(var i=1;i&lt;guess[2].length;i++){
						if(guess[2].charAt(i)=="+"||guess[2].charAt(i)=="-"){
							ver1[ind3] = guess[2].substr(0,i);
							ind3++;
							guess[2] = guess[2].substr(i,guess[2].length);
							i=1;
						}
					}
					for(var i=1;i&lt;guess[3].length;i++){
						if(guess[3].charAt(i)=="+"||guess[3].charAt(i)=="-"){
							ver2[ind4] = guess[3].substr(0,i);
							ind4++;
							guess[3] = guess[3].substr(i,guess[3].length);
							i=1;
						}
					}
					ansArr.push(guess[0]);
					ansArr.sort();
					addPlusChar(ansArr);
					ansArrBelow.push(guess[1]);
					ansArrBelow.sort();
					addPlusChar(ansArrBelow);
					ver1.push(guess[2]);
					ver1.sort();
					addPlusChar(ver1);
					ver2.push(guess[3]);
					ver2.sort();
					addPlusChar(ver2);
					return (checkArr(ansArr,ver1)&&checkArr(ansArrBelow,ver2))||(checkReverse(ansArr,ver1)&&checkReverse(ansArrBelow,ver2));
				</div>
			</div>
			<p class="example">分別填入分子與分母</p>
			<p class="example">分子與分母的式子要最簡</p>
			<p class="example"><code>x*3</code> 要寫成 <code>3x</code></p>
			<p class="example"><code>y^{2}</code> 寫成 <code>y</code>^<code>2</code></p>
        </div>

        <div class="hints">
            <p data-if="SIGN === '+'">為了使式子可加，它們必須有一個公分母，</p>
            <p data-else="">為了使式子可減，它們必須有一個公分母，</p>

            <div data-if="D2.toString() !== '1'" data-unwrap="">
                <p>將第一項乘以 <code>\dfrac{<var>D2</var>}{<var>D2</var>}</code>。</p>

                <p><code> \qquad
                    \dfrac{<var>N1</var>}{<var>D1</var>} \times \dfrac{<var>D2</var>}{<var>D2</var>} = 
                    \dfrac{<var>N_PRODUCT1</var>}{<var>D_PRODUCT</var>}
                </code></p>
            </div>

            <div data-if="D1.toString() !== '1'" data-unwrap="">
                <p>將第二項乘以 <code>\dfrac{<var>D1</var>}{<var>D1</var>}</code>。</p>

                <p><code> \qquad
                    \dfrac{<var>N2</var>}{<var>D2</var>} \times \dfrac{<var>D1</var>}{<var>D1</var>} = 
                    \dfrac{<var>N_PRODUCT2</var>}{<var>D_PRODUCT</var>}
                </code></p>
            </div>

            <div>
                <p>因此</p>
                <p><code> \qquad <var>Y</var> =
                    \dfrac{<var>N_PRODUCT1</var>}{<var>D_PRODUCT</var>} <var>SIGN</var> 
                    \dfrac{<var>N_PRODUCT2</var>}{<var>D_PRODUCT</var>}
                </code></p>
            </div>

            <div data-if="SIGN === '-'" data-unwrap="">
                <div>
                    <p>現在，這兩式都有同一個分母，我們可以簡單地讓分子相減 <code>:</code></p>
                    <p><code><var>Y</var> =
                        \dfrac{<var>N_PRODUCT1</var> - 
                            <span data-if="N_PRODUCT2.terms !== undefined">(<var>N_PRODUCT2</var>)</span>
                            <span data-else=""><var>N_PRODUCT2</var></span>
                        }{<var>D_PRODUCT</var>}
                    </code></p>
                </div>

                <div>
                    <div>
                        <p>分配負號 <code>:</code></p>
                        <p><code><var>Y</var> = \dfrac{<var>N_PRODUCT1</var> + <var>N_PRODUCT2.multiply(-1)</var>}{<var>D_PRODUCT</var>}</code></p>
                    </div>
                </div>
            </div>

            <div data-else="">
                <p>現在，這兩式都有同一個分母，我們可以簡單地讓分子相加 <code>:</code></p>
                <p><code><var>Y</var> =
                    \dfrac{<var>N_PRODUCT1</var> + <var>N_PRODUCT2</var>}{<var>D_PRODUCT</var>}
                </code></p>
            </div>

            <p><code><var>Y</var> = \dfrac{<var>N_SUM</var>}{<var>D_PRODUCT</var>}</code></p>

            <div data-if="FACTOR.toString() !== '1'">
                <div>通過將分子和分母同時除以 <var>FACTOR</var> ，化簡得 <code>:</code></div>
                <div><code><var>Y</var> = \dfrac{<var>NUMERSOL</var>}{<var>DENOMSOL</var>}</code></div>
            </div>

        </div>
    </div>
</body>
</html>
